!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Malta=t():e.Malta=t()}(self,(()=>(()=>{"use strict";var e={755:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CssInJs=t.generateName=void 0;const n=new Map,o=new Set;document.createElement("style");t.generateName=e=>{let t="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",s=n.length;for(var i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*s));return o.add(t),t};const s=(e,t)=>{var n,o;const i=[];return i.push(`.${e}{${t.main}}`),(null===(n=null==t?void 0:t.queries)||void 0===n?void 0:n.length)>0&&t.queries.forEach((t=>i.push(`${t.type}{${s(e,t.rule).join("")}}`))),(null===(o=null==t?void 0:t.pseudo)||void 0===o?void 0:o.length)>0&&t.pseudo.forEach((t=>i.push(`.${e}${t.type}{${t.rule}}`))),i};t.CssInJs=class{static inline(e){const t={main:"",pseudo:[],queries:[]};return Object.keys(e).map((n=>{const o=n.split(/(?=[A-Z])/).join("-").toLowerCase();if("inline"!==n)return o.startsWith("&")?t.pseudo.push({type:o.replace("&",""),rule:this.inline(e[n]).main}):o.startsWith("@")?t.queries.push({type:o,rule:this.inline(e[n])}):t.main+=`${o}:${e[n]};`})),t}static toCss(e){const i=JSON.stringify(e);if(n.has(i)){const e=n.get(i);if(e)return e}const r=(e=>{var n,i;let r=`malta-${(0,t.generateName)(10)}`;const c=null!==(i=null===(n=document.getElementsByTagName("style")[0])||void 0===n?void 0:n.sheet)&&void 0!==i?i:document.head.appendChild(document.createElement("style")).sheet;for(;o.has(r);)r=`malta-${(0,t.generateName)(10)}`;const a=s(r,e);for(const e of a)c.insertRule(e,c.cssRules.length);return r})(this.inline(e));return n.set(i,r),r}}},227:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Dom=void 0;const o=n(755);t.Dom=class{constructor({node:e,el:t}){e&&(this.node=e),t&&(this.el=t)}create(){const e=document.createElement(this.node.tag);e.$current=this.node,this.el=e}setAttributes(){var e;const t=null===(e=this.node)||void 0===e?void 0:e.attrs;if(t)for(const e in t)this.el.setAttribute(e,t[e])}textNode(){var e;const t=null===(e=this.node)||void 0===e?void 0:e.textNode;if(t&&"boolean"!=typeof t){const e=document.createTextNode(String(t));this.el.appendChild(e)}}initEvents(){for(const e in this.node)if(e.startsWith("on")){const t=e.toLowerCase(),n=this.node[e];this.el[t]=n}}style(){var e;if(this.node.style){if(this.node.style.inline)return this.el.setAttribute("style",o.CssInJs.inline(this.node.style).main);const t=this.el.classList;t.forEach((e=>{if(e.startsWith("malta"))return t.remove(e)}));const n=o.CssInJs.toCss(null===(e=this.node)||void 0===e?void 0:e.style);return this.el.classList.add(n)}}}},926:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MakeEffect=void 0;t.MakeEffect=(e,t)=>{if(0===t.length)return e();let n=!1;const o=()=>{n||(n=!0,Promise.resolve().then((()=>{n=!1,e()})))};return t.forEach((e=>{e.effect&&e.effect(o)}))}},881:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Render=void 0;const o=n(994);t.Render=(e,t=document.body)=>{if(Array.isArray(e))return void e.forEach((e=>{const n=o.VDom.mount(e);n&&t.appendChild(n)}));const n=o.VDom.mount(e);n&&t.appendChild(n)}},107:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.State=t.StateStack=void 0;const o=n(994);class s{static get stack(){return this.data}static push(e){this.data.add(e)}static reset(){this.data.clear()}static setContext(e){for(const t of this.data)t.apply(e)}}t.StateStack=s,s.data=new Set,t.State=function(e){const t=new Set,n=new Set;let i=e;function r(){return s.push(r),this&&t.add(this),i}return r.effect=function(e){n.add(e)},[r,function(e){if(e!==i){for(const e of n)e();i="function"==typeof e?e(i):e;for(const e of t){const t=e.el.$component;if(t){const n=t();o.VDom.update({current:e.el.$current,next:n,el:e.el}),s.reset()}}}}]}},994:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VDom=void 0;const o=n(107),s=n(365),i=n(227);t.VDom=class{static mount(e){const t=new i.Dom({node:(0,s.isFunction)(e)});if(t.node){if(t.create(),"function"==typeof e&&(t.el.$component=e,o.StateStack.setContext(t)),t.setAttributes(),t.textNode(),t.style(),t.initEvents(),t.node.content)if(Array.isArray(t.node.content))t.node.content.forEach((e=>{if("boolean"!=typeof e){const n=this.mount(e);n&&t.el.appendChild(n)}}));else{const e=this.mount(t.node.content);e&&t.el.appendChild(e)}return o.StateStack.reset(),t.el}}static update({current:e,next:t,el:n}){if(e.tag!==(null==t?void 0:t.tag)){const e=this.mount(t);e&&n.replaceWith(e)}const{content:o,attrs:r,textNode:c,style:a}=t,l=a&&(0,s.compareObjects)(e.style,a),d=new i.Dom({node:t,el:n});if(o){for(let e=0;e<n.children.length;e++){const t=o[e];for(;!t&&n.children[e];)n.removeChild(n.children[e]);"function"==typeof t&&(n.children[e].$component=t,t.call(n.children[e])),n.children[e]&&this.update({current:n.children[e].$current,next:(0,s.isFunction)(t),el:n.children[e]})}for(const e in o)if(!n.children[e]){const t=this.mount(o[e]);t&&n.appendChild(t)}}if(r&&d.setAttributes(),l||d.style(),c&&"boolean"!=typeof c&&(null==e?void 0:e.textNode)!==c){const e=null==n?void 0:n.childNodes;for(const t in e)"#text"===e[t].nodeName&&(e[t].nodeValue=String(c))}d.initEvents(),n.$current=t}}},365:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=t.compareObjects=void 0;t.compareObjects=(e,n)=>{let o=!0;for(const s in e){if("object"==typeof e[s])return(0,t.compareObjects)(e[s],n[s]);e[s]!==n[s]&&(o=!1)}return o};t.isFunction=e=>"function"==typeof e?e():e}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}var o={};return(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0}),e.State=e.Render=e.MakeEffect=void 0;const t=n(926);Object.defineProperty(e,"MakeEffect",{enumerable:!0,get:function(){return t.MakeEffect}});const s=n(881);Object.defineProperty(e,"Render",{enumerable:!0,get:function(){return s.Render}});const i=n(107);Object.defineProperty(e,"State",{enumerable:!0,get:function(){return i.State}})})(),o})()));